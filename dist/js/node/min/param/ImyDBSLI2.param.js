!function(n){"use strict";var e=require("../lib/SyncPromise.js").SyncPromise,t=require("../lib/util.js").util,a={idx:{name:"imy_indices",all_columns:["type","value","data_id","content_pos1","content_pos2","sort_flag","skip"],create:null,drop:null,index:[],select:{},insert:null,update:{},"delete":{}},fr:{name:"imy_idx_fragments",all_columns:["type","value"],create:null,drop:null,index:[],select:{},insert:null,update:{},"delete":{}},pa:{name:"imy_idx_parameters",all_columns:["type","idx_fragment_id","skip","data_id","content_pos1","content_pos2","sort_flag"],create:null,drop:null,index:[],select:{},insert:null,update:{},"delete":{}},da:{name:"imy_data",all_columns:["id","type","content","created_at","updated_at"],create:null,drop:null,index:[],select:{},insert:null,update:{},"delete":{}}};a.search={"index.for_type_values":function(n,r){if(t.hasProperty(r,["type","values"]))return new e(function(e,t){n.select(function(n,e){n(e.type).as("type"),n(e.data_id).as("data_id"),n(e.value).as("value"),n(e.content_pos1).as("d_content_pos1"),n(e.content_pos2).as("d_content_pos2"),n(e.sort_flag).as("sort_flag")}).from(a.idx.name).where(function(n){n.and("type").eq.value(r.type),n.and("value")["in"].value(r.value)}).groupBy(["group","type","data_id","value","d_content_pos1","d_content_pos2"]).orderBy(["group","type","data_id","d_content_pos1","d_content_pos2","value"]).run(function(n,t){t(),e(n)})["catch"](t)})},"parametered_fragment.for_type_values":function(n,r){if(t.hasProperty(r,["type","values"]))return new e(function(e,t){n.select(function(n,e){n(e.p.type).as("type"),n(e.p.data_id).as("data_id"),n(e.f.value).as("value"),n(e.p.content_pos1).as("d_content_pos1"),n(e.p.content_pos2).as("d_content_pos2"),n(e.p.sort_flag).as("sort_flag")}).from(a.fr.name).as("f").innerJoin(a.pa.name,function(n){n.and("f.type").eq.key("p.type"),n.and("f.id").eq.key("p.idx_fragment_id")}).as("p").where(function(n){n.and("f.type").eq.value(r.type),n.and("f.value")["in"].value(r.values)}).groupBy(["type","data_id","value","d_content_pos1","d_content_pos2"]).orderBy(["type","data_id","d_content_pos1","d_content_pos2","value"]).run(function(n,t){t(),e(n)})["catch"](t)})}},a.count={"index.for_type_value":function(n,r){if(t.hasProperty(r,["type","value"]))return new e(function(e,t){n.select(function(n,e){n.count(e.id)}).from(a.idx.name).where(function(n){n.and("type").eq.value(r.type),n.and("value").eq.value(r.value)}).run(function(n,t){t(),e(n)})["catch"](t)})},"parametered_fragment.for_type_value":function(n,r){if(t.hasProperty(r,["type","value"]))return new e(function(e,t){n.select(function(n,e){n.count(e.f.id)}).from(a.fr.name).as("f").innerJoin(a.pa.name,function(n){n.and("f.type").eq.key("p.type"),n.and("f.id").eq.key("p.idx_fragment_id")}).as("p").where(function(n){n.and("f.type").eq.value(r.type),n.and("f.value").eq.value(r.value)}).groupBy(["f.id"]).run(function(n,t){t(),e(n)})["catch"](t)})}},a.idx.create=function(n){var t=this;return new e(function(e,a){n.createTable(t.name,{keyPath:"id",autoIncrement:!0}).run(function(n,t){t(),e(n)})["catch"](a)})},a.idx.drop=function(n){var t=this;return new e(function(e,a){n.dropTable(t.name).run(function(n,t){t(),e(n)})["catch"](a)})},a.idx.index=[{columns:["type","value","skip","data_id","content_pos1","content_pos2"],name:"imy_index_idx1",create:function(n){var t=this;return new e(function(e,r){n.createIndex(a.idx.name,t.name,t.columns).run(function(n,t){t(),e(n)})["catch"](r)})},drop:function(n){var t=this;return new e(function(e,r){n.dropIndex(a.idx.name,t.name).run(function(n,t){t(),e(n)})["catch"](r)})}}],a.idx.select={},a.idx.insert=function(n,a){if(t.hasProperty(a,[this.all_columns])){var r=this,o={type:a.type,value:a.value,data_id:a.data_id,content_pos1:a.content_pos1,content_pos2:a.content_pos2,skip:a.skip};return new e(function(e,t){n.insertInto(r.name).values(o).run(function(n,t){t(),e(n)})["catch"](t)})}},a.idx["delete"]={all:function(n){var t=this;return new e(function(e,a){n.deleteFrom(t.name).run(function(n,t){t(),e(n)})["catch"](a)})}.bind(a.idx),for_dataid:function(n,a){var r=this;if(t.hasProperty(a,["data_id"]))return new e(function(e,t){n.deleteFrom(r.name).where(function(n){n.and("data_id").eq.value(a.data_id)}).run(function(n,t){t(),e(n)})["catch"](t)})}.bind(a.idx)},a.fr.create=function(n){var t=this;return new e(function(e,a){n.createTable(t.name,{keyPath:"id",autoIncrement:!0}).run(function(n,t){t(),e(n)})["catch"](a)})},a.fr.drop=function(n){var t=this;return new e(function(e,a){n.dropTable(t.name).run(function(n,t){t(),e(n)})["catch"](a)})},a.fr.select={all:function(n){var a=this;return new e(function(e,r){n.select(t._columns(a.all_columns.concat("id"))).from(a.name).run(function(n,t){t(),e(n)})["catch"](r)})}.bind(a.fr),"id.for_type_value":function(n,a){if(t.hasProperty(a,["type","value"])){var r=this;return new e(function(e,t){n.select(function(n,e){n(e.f.id).as("id")}).from(r.name).as("f").where(function(n){n.and("f.type").eq.value(a.type),n.and("f.value").eq.value(a.value)}).run(function(n,t){t(),e(n)})["catch"](t)})}}.bind(a.fr)},a.fr.insert=function(n,a){if(t.hasProperty(a,this.all_columns)){var r=this,o={type:a.type,value:a.value};return new e(function(e,t){n.insertInto(r.name).values(o).run(function(n,t){t(),e(n)})["catch"](t)})}},a.fr["delete"]={all:function(n){var t=this;return new e(function(e,a){n.deleteFrom(t.name).run(function(n,t){t(),e(n)})["catch"](a)})}.bind(a.fr),for_type_value:function(n,a){if(t.hasProperty(a,["type","value"])){var r=this;return new e(function(e,t){n.deleteFrom(r.name).where(function(n){n.and("type").eq.value(a.type),n.and("value").eq.value(a.value)}).run(function(n,t){t(),e(n)})["catch"](t)})}}.bind(a.fr)},a.pa.create=function(n){var t=this;return new e(function(e,a){n.createTable(t.name,{keyPath:"id",autoIncrement:!0}).run(function(n,t){t(),e(n)})["catch"](a)})},a.pa.drop=function(n){var t=this;return new e(function(e,a){n.dropTable(t.name).run(function(n,t){t(),e(n)})["catch"](a)})},a.pa.index=[{name:"imy_idx_parameter_idx1",columns:["type","idx_fragment_id","skip","data_id","content_pos1","content_pos2"],create:function(n){var t=this;return new e(function(e,r){n.createIndex(a.pa.name,t.name,t.columns).run(function(n,t){t(),e(n)})["catch"](r)})},drop:function(n){var t=this;return new e(function(e,r){n.dropIndex(a.pa.name,t.name).run(function(n,t){t(),e(n)})["catch"](r)})}}],a.pa.select={all:function(n){var a=this;return new e(function(e,r){n.select(t._columns(a.all_columns)).from(a.name).run(function(n,t){t(),e(n)})["catch"](r)})}.bind(a.pa)},a.pa.insert=function(n,a){if(t.hasProperty(a,this.all_columns)){var r=this,o={type:a.type,idx_fragment_id:a.idx_fragment_id,data_id:a.data_id,content_pos1:a.content_pos1,content_pos2:a.content_pos2,sort_flag:a.sort_flag,skip:a.skip};return new e(function(e,t){n.insertInto(r.name).values(o).run(function(n,t){t(),e(n)})["catch"](t)})}},a.pa["delete"]={all:function(n){var t=this;return new e(function(e,a){n.deleteFrom(t.name).run(function(n,t){t(),e(n)})["catch"](a)})}.bind(a.pa),for_dataid:function(n,a){var r=this;if(t.hasProperty(a,["data_id"]))return new e(function(e,t){n.deleteFrom(r.name).where(function(n){n.and("data_id").eq.value(a.data_id)}).run(function(n,t){t(),e(n)})["catch"](t)})}.bind(a.pa)},a.da.create=function(n){var t=this;return new e(function(e,a){n.createTable(t.name,{keyPath:"id",autoIncrement:!0}).run(function(n,t){t(),e(n)})["catch"](a)})},a.da.drop=function(n){var t=this;return new e(function(e,a){n.dropTable(t.name).run(function(n,t){t(),e(n)})["catch"](a)})},a.da.index=[{columns:["type","content"],name:"imy_data_idx1",create:function(n){var t=this;return new e(function(e,r){n.createIndex(a.da.name,t.name,t.columns).run(function(n,t){t(),e(n)})["catch"](r)})},drop:function(n){var t=this;return new e(function(e,r){n.dropIndex(a.da.name,t.name).run(function(n,t){t(),e(n)})["catch"](r)})}}],a.da.select={"all.for":function(n,a){var r=this;return new e(function(e,o){n.select(t._columns(r.all_columns)).from(r.name).where(function(n){t.hasProperty(a,["id"])&&n.and("id").eq.value(a.id),t.hasProperty(a,["type"])&&n.and("type").eq.value(a.type),t.hasProperty(a,["content"])&&n.and("content").eq.value(a.content)}).run(function(n,t){t(),e(n)})["catch"](o)})}.bind(a.da)},a.da.insert=function(n,a){if(t.hasProperty(a,["type","content"])){var r=this,o={type:a.type,content:a.content};return new e(function(e,t){n.insertInto(r.name).values(o).run(function(n,t){t(),e(n)})["catch"](t)})}},a.da.update={"for":function(n,a,r){var o=this,i={};return t.hasProperty(a,["content"])&&(i.content=a.content),t.hasProperty(a,["type"])&&(i.type=a.type),i.updated_at=t._date(n,new Date),new e(function(e,a){n.update(o.name).set(i).where(function(n){t.hasProperty(r,["id"])&&n.and("id").eq.value(r.id),t.hasProperty(r,["type"])&&n.and("type").eq.value(r.type),t.hasProperty(r,["content"])&&n.and("content").eq.value(r.content)}).run(function(n,t){t(),e(n)})["catch"](a)})}.bind(a.da)},a.da["delete"]={all:function(n){var t=this;return new e(function(e,a){n.deleteFrom(t.name).run(function(n,t){t(),e(n)})["catch"](a)})}.bind(a.da),"for":function(n,a){if(t.hasProperty(a,["id"])){var r=this;return new e(function(e,t){n.deleteFrom(r.name).where(function(n){n.and("id").eq.value(a.id)}).run(function(n,t){t(),e(n)})["catch"](t)})}}.bind(a.da)},n.ImyDBSLI2=a}(this);